<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Coin Flip Puzzle</title>
  <style>
    /* === Base Layout === */
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      margin: 0;
      padding: 20px;
      transition: background 0.5s, color 0.5s;
      perspective: 1000px;
    }

    h1 {
      margin-bottom: 5px;
      transition: color 0.5s;
    }

    #levelDisplay {
      font-size: 20px;
      margin: 10px 0;
      font-weight: bold;
    }

    .coin-row {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      margin: 15px 0;
      perspective: 1000px;
    }

    .coin {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 8px;
      cursor: pointer;
      font-weight: bold;
      font-size: 22px;
      transition: transform 0.6s;
      transform-style: preserve-3d;
      position: relative;
      box-shadow: 0 4px 8px rgba(0,0,0,0.25);
    }

    .coin:hover {
      transform: scale(1.1);
    }

    /* Front and back faces */
    .face {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 2px solid #aaa;
      font-weight: bold;
    }

    .front {
      background: radial-gradient(circle at top left, gold, goldenrod);
      color: black;
    }

    .back {
      background: radial-gradient(circle at top left, silver, gray);
      color: black;
      transform: rotateY(180deg);
    }

    .flip {
      transform: rotateY(180deg);
    }

    #info {
      margin: 15px 0;
      font-size: 18px;
    }

    #stopwatch {
      position: fixed;
      top: 10px;
      right: 20px;
      font-size: 20px;
      font-weight: bold;
      background: white;
      padding: 6px 12px;
      border: 2px solid #333;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }

    button {
      padding: 10px 20px;
      font-size: 16px;
      border: none;
      border-radius: 10px;
      background: #4CAF50;
      color: white;
      cursor: pointer;
      transition: 0.3s;
      margin: 5px;
    }

    button:hover {
      transform: scale(1.05);
    }

    select {
      padding: 8px;
      border-radius: 8px;
      font-size: 15px;
      margin-top: 5px;
    }

    /* === THEMES === */
    body.light {
      background: linear-gradient(to bottom right, #f0f9ff, #cbebff);
      color: #222;
    }

    body.dark {
      background: linear-gradient(to bottom right, #1a1a1a, #333);
      color: #eee;
    }

    body.green {
      background: linear-gradient(to bottom right, #e3f9e5, #a8e6a1);
      color: #1f3d1f;
    }

    body.blue {
      background: linear-gradient(to bottom right, #d0e9ff, #91c9f7);
      color: #06283D;
    }

    body.orange {
      background: linear-gradient(to bottom right, #ffe4c4, #ffb347);
      color: #4a2c00;
    }
  </style>
</head>
<body class="light">
  <h1>ü™ô Coin Flip Puzzle</h1>
  <div id="stopwatch">‚è± 0.0s</div>
  <p id="levelDisplay">Level 1</p>

  <label for="themeSelector">üé® Theme:</label>
  <select id="themeSelector">
    <option value="light">Light</option>
    <option value="dark">Dark</option>
    <option value="green">Green</option>
    <option value="blue">Blue</option>
    <option value="orange">Orange</option>
  </select>

  <div id="game">
    <p id="target">Target Pattern:</p>
    <div class="coin-row" id="coins"></div>
    <div class="coin-row" id="targetRow"></div>
    <div id="info">
      <p>Moves: <span id="moves">0</span></p>
    </div>
    <button onclick="resetGame()">Restart Level</button>
  </div>

  <script>
    let level = 1;
    let coins = [];
    let target = [];
    let moves = 0;
    let startTime = null;
    let timerInterval;

    const coinsDiv = document.getElementById("coins");
    const targetDiv = document.getElementById("targetRow");
    const movesDisplay = document.getElementById("moves");
    const stopwatchDisplay = document.getElementById("stopwatch");
    const levelDisplay = document.getElementById("levelDisplay");

    function coinsForLevel(lv) {
      if (lv === 1) return 5;
      if (lv === 2) return 10;
      if (lv === 3) return 15;
      return 20;
    }

    function generateTarget(n) {
      return Array.from({ length: n }, () =>
        Math.random() > 0.5 ? "H" : "T"
      );
    }

    function render() {
      coinsDiv.innerHTML = "";
      targetDiv.innerHTML = "";

      coins.forEach((c, i) => {
        const coin = document.createElement("div");
        coin.className = "coin" + (c === "T" ? " flip" : "");

        const front = document.createElement("div");
        front.className = "face front";
        front.textContent = "H";

        const back = document.createElement("div");
        back.className = "face back";
        back.textContent = "T";

        coin.appendChild(front);
        coin.appendChild(back);
        coin.onclick = () => flipCoin(i, coin);
        coinsDiv.appendChild(coin);
      });

      target.forEach((c) => {
        const coin = document.createElement("div");
        coin.className = "coin" + (c === "T" ? " flip" : "");
        const front = document.createElement("div");
        front.className = "face front";
        front.textContent = "H";
        const back = document.createElement("div");
        back.className = "face back";
        back.textContent = "T";
        coin.appendChild(front);
        coin.appendChild(back);
        targetDiv.appendChild(coin);
      });

      movesDisplay.textContent = moves;
      levelDisplay.textContent = "Level " + level;
    }

    function flipCoin(index, coinElement) {
      if (!startTime) startStopwatch();
      coinElement.classList.toggle("flip");
      coins[index] = coins[index] === "H" ? "T" : "H";
      moves++;
      movesDisplay.textContent = moves;
      checkWin();
    }

    function checkWin() {
      if (coins.join("") === target.join("")) {
        stopStopwatch();
        setTimeout(() => {
          alert(`üéâ You completed Level ${level}!\nMoves: ${moves}\nTime: ${stopwatchDisplay.textContent}`);
          level++;
          resetGame();
        }, 100);
      }
    }

    function resetGame() {
      moves = 0;
      const n = coinsForLevel(level);
      coins = Array(n).fill("H");
      target = generateTarget(n);
      resetStopwatch();
      render();
    }

    // Stopwatch
    function startStopwatch() {
      startTime = Date.now();
      timerInterval = setInterval(() => {
        let elapsed = (Date.now() - startTime) / 1000;
        stopwatchDisplay.textContent = `‚è± ${elapsed.toFixed(1)}s`;
      }, 100);
    }

    function stopStopwatch() {
      clearInterval(timerInterval);
    }

    function resetStopwatch() {
      clearInterval(timerInterval);
      startTime = null;
      stopwatchDisplay.textContent = "‚è± 0.0s";
    }

    // Theme selector
    const themeSelector = document.getElementById("themeSelector");
    themeSelector.addEventListener("change", (e) => {
      document.body.className = e.target.value;
    });

    resetGame();
  </script>
</body>
</html>
